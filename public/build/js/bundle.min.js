!function(){if(document.querySelector("#mensajes")){document.querySelector("#enviarmensaje").addEventListener("click",async()=>{const t=document.querySelector("#mensaje").value;if(t){const e=new URL(window.location);if(e.href.includes("chats")){const o=new FormData,a=e.searchParams.get("idamigo");o.append("idAmigo",a);try{const e="http://localhost:3000/api/busquedadegrupo",a=await fetch(e,{method:"POST",body:o}),n=await a.json();if(n)console.log(n),console.log("hay resultados"),async function(e){try{const o="http://localhost:3000/api/enviarmensaje",a=new FormData;a.append("contenido",t),a.append("grupoId",e);const n=await fetch(o,{method:"POST",body:a}),c=await n.json();c&&console.log(c)}catch(t){}}(n);else try{console.log("intentando crear el chat");const t="http://localhost:3000/api/crearchat",e=await fetch(t,{method:"POST",body:o}),a=await e.json();a?console.log(a):console.log("no se creo el chat")}catch(t){}}catch(t){}}}})}}(),function(){const t=document.getElementById("lupa");if(t){const o=document.getElementById("busqueda"),a=document.getElementById("busqueda__input");function e(t){const{usuarioAmigoId:e,usuarioId:o,estado:a}=t;let n=document.querySelector(`[data-id="${e}"]`);n||(n=document.querySelector(`[data-id="${o}"]`)),0==a&&(n.textContent="Pendiente",n.disabled=!0),1==a&&(n.textContent="Agregado",n.disabled=!0)}t.onclick=function(){const t=document.querySelector(".mostrar");if(t)return o.classList.add("mostrar"),void t.classList.remove("mostrar");o.classList.add("mostrar")},a.addEventListener("input",(function(){let t=this.value;t.length>3&&async function(t){const o=new FormData;o.append("busqueda",t);try{const t="http://localhost:3000/api/busquedausuarios",a=await fetch(t,{method:"POST",body:o}),n=await a.json();n&&function(t){const o=document.getElementById("busqueda__resultados");o.innerHTML="",t.forEach(t=>{const a=document.createElement("DIV");a.classList.add("busqueda-resultado");const n=document.createElement("DIV");n.classList.add("busqueda-resultado__imagen"),a.appendChild(n);const c=document.createElement("P");c.classList.add("busqueda-resultado__nickname"),c.textContent=t.nickname,a.appendChild(c);const s=document.createElement("BUTTON");s.classList.add("busqueda-resultado__agregar"),s.textContent="Agregar",s.dataset.id=t.id,async function(t){const o=new FormData;o.append("amigoId",t);try{const t="http://localhost:3000/api/estadorelacion",a=await fetch(t,{method:"POST",body:o}),n=await a.json();n&&(console.log(n),e(n))}catch(t){}}(t.id),s.addEventListener("click",()=>{!async function(t){const o=new FormData;o.append("amigoId",t);try{const t="http://localhost:3000/api/agregaamigo",a=await fetch(t,{method:"POST",body:o}),n=await a.json();n&&e(n)}catch(t){}}(t.id)}),a.appendChild(s),o.appendChild(a)})}(n)}catch(t){}}(t)}))}}(),function(){const t=document.getElementById("campana");if(t){const e=document.getElementById("notificaciones");t.onclick=function(){const t=document.querySelector(".mostrar");if(t)return e.classList.add("mostrar"),void t.classList.remove("mostrar");e.classList.add("mostrar"),async function(){try{const t="http://localhost:3000/api/notificaciones",o=await fetch(t,{method:"POST"}),a=await o.json();a&&(console.log(a),function(t){if(console.log(t),e.innerHTML="",0==t.length){const t=document.createElement("P");t.textContent="No Tienes Solicitudes de amistad",t.classList.add("notificacion__vacio"),e.append(t)}t.forEach(t=>{const o=document.createElement("DIV");o.classList.add("notificacion");const a=document.createElement("DIV");a.classList.add("notificacion__imagen"),o.appendChild(a);const n=document.createElement("P");n.classList.add("notificacion__nickname"),n.textContent=t.nickname,n.dataset.usuario_id=t.usuario_id,o.appendChild(n);const c=document.createElement("BUTTON");c.classList.add("notificacion__agregar"),c.textContent="Agregar",c.dataset.id=t.id,c.addEventListener("click",()=>{!async function(t){const e=document.querySelector(`[data-id="${t}"]`);try{const o="http://localhost:3000/api/agregar",a=new FormData;a.append("id",t);const n=await fetch(o,{method:"POST",body:a}),c=await n.json();c&&(console.log(c),e.textContent="Agregado")}catch(t){}}(t.id)}),o.appendChild(c),e.appendChild(o)})}(a))}catch(t){}}()}}}(),function(){const t=document.querySelector("#publicar");if(t){const e=document.querySelector("#publicacion");t.onclick=()=>{const t=document.querySelector(".mostrar");if(t)return e.classList.add("mostrar"),void t.classList.remove("mostrar");e.classList.add("mostrar")};const o=document.getElementById("publicacion__imagen"),a=document.getElementById("publicacion__texto");document.getElementById("publicacion__boton").onclick=async function(){const t=o.files[0];console.log(t),datos=new FormData,datos.append("mensaje",a.value),datos.append("imagen",t);try{const t="http://localhost:3000/api/publicar",e=await fetch(t,{method:"POST",body:datos}),o=await e.json();o&&console.log(o)}catch(t){}}}}(),function(){const t=document.querySelector(".amigos");if(t){document.addEventListener("DOMContentLoaded",()=>{!async function(){try{const e="http://localhost:3000/api/busquedaAmigos",o=await fetch(e,{method:"POST"}),a=await o.json();if(a){console.log(a);const e=a[0],o=a[1];!function(e){if(!e)return;e.forEach(e=>{const o=document.createElement("DIV");o.classList.add("amigo"),o.onclick=()=>{const t=new URL(window.location);t.searchParams.set("idamigo",e.usuarioAmigoId),window.history.pushState({},"",t),t.href.includes("chats")||(window.location.href="http://localhost:3000/dashboard/chats?idamigo="+e.usuarioAmigoId)},o.dataset.idAmigo=e.usuarioAmigoId;const a=document.createElement("DIV");a.classList.add("amigo__imagen");const n=document.createElement("P");n.classList.add("amigo__nombre"),n.dataset.id=e.usuarioAmigoId,o.appendChild(a),o.appendChild(n),t.appendChild(o),async function(t){const e=new FormData;e.append("id",t);try{const o="http://localhost:3000/api/busquedaNombreUsuario",a=await fetch(o,{method:"POST",body:e}),n=await a.json();if(n){document.querySelector(`[data-id="${t}"]`).textContent=n.nickname}}catch(t){}}(e.usuarioAmigoId)})}(e.map(t=>(t.usuarioId!=o&&(t.usuarioAmigoId=t.usuarioId),t)))}}catch(t){}}()})}}(),function(){const t=document.getElementById("publicaciones");if(t){document.addEventListener("DOMContentLoaded",(function(){!async function(){datos=new FormData;try{const e="http://localhost:3000/api/busquedapublicaciones",o=await fetch(e,{method:"POST",body:datos}),a=await o.json();a&&(console.log(a),a.forEach(e=>{const o=document.createElement("DIV");o.classList.add("post");const a=document.createElement("DIV");a.classList.add("post__perfil");const n=document.createElement("DIV");n.classList.add("post__imagen-perfil"),a.appendChild(n);const c=document.createElement("P");c.textContent=e.nickname,c.classList.add("post__nickname"),a.appendChild(c),o.appendChild(a);const s=document.createElement("P");if(s.textContent=e.mensaje,s.classList.add("post__texto"),o.appendChild(s),e.imagen){const t=document.createElement("IMG");t.setAttribute("src","/imagenes-publicaciones/"+e.imagen),t.classList.add("post__imagen"),o.appendChild(t)}t.appendChild(o)}))}catch(t){}}()}))}}();
//# sourceMappingURL=bundle.js.map
